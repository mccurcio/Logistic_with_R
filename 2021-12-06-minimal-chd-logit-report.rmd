---
title: "The Framingham Heart Study"
subtitle: "Risk Factors For Cardiac Heart Disease"
author: "Report by Matthew Curcio"
date: "12-02-21"
output: html_document
---


## USE https://stats.idre.ucla.edu/r/dae/logit-regression/
for analysis

## USE https://stats.idre.ucla.edu/other/mult-pkg/faq/general/faq-how-do-i-interpret-odds-ratios-in-logistic-regression/
for interpretation

---

## Executive Summary

- The Framingham Heart Study (FHS) is a longitudinal study that investigated **4,133 participants** over a ten (10) year period.
- The purpose of the FHS is to **determine the risk factors for cardiovascular disease** by following 13 variables.


The five most important factors that determine the risk of cardiac heart disease are:

- By being a men vs women, the log-odds of acquiring CHD is an increase of 0.527. 

- If there is a history of Hypertension, the log-odds of acquiring CHD increase by 0.332.

- For every year in age the log odds of acquiring CHD increase by 0.0602.

- For every Cigarettes/day the log odds of acquiring CHD increase by 0.0204.

- For every Systolic BP the log odds of acquiring CHD increase by 0.0133.



--- 

## Disscussion


- The data from the Framingham Heart Study can be found at https://www.kaggle.com/captainozlem/framingham-chd-preprocessed-data.

The goal of this study is to determine which conditions lead to a high probability of a person acquiring cardiovascular disease.

Logistic regression is used to understand the relationship between the dependent variable and one or more independent variables by estimating probabilities using a logistic regression equation. This type of analysis can help you predict the likelihood of an event happening or a choice being made. [^2]

[^2]:https://www.ibm.com/topics/logistic-regression


- The dependent variable is the incidence of acquiring cardiac hear disease (CHD) after ten years from testing.  The variable name in this study is abbreviated `TenYearCHD`.

- The model is fit with 14 independent variables.

--- 
| Dependent variable (Yes, No)          | 
| :------------------------------------ | 
| Cardiac Heart Disease After Ten Years | 

| No. | Independent Variables (Yes = 1) | No. | Independent Continuous Variables |
| :-- | :------------------------------ | :-- | :------------------------------- |
| 1   | Male 1                          | 1   | Age                              |
| 2   | Education 1                     | 2   | Cigarettes Per Day               |
| 3   | Current Smoker 1                | 3   | Total Cholesterol                |
| 4   | Prevalence of Stroke 1          | 4   | Systolic BP                      |
| 5   | Prevalence of Hypertension 1    | 5   | Diastolic BP                     |
| 6   | Diabetic 1                      | 6   | BMI                              |
|     |                                 | 7   | HeartRate                        |
|     |                                 | 8   | Glucose                          |


```{r DONOTSHOW, message=FALSE, warning=FALSE, include=FALSE}
# DO NOT SHOW
options(tinytex.verbose = TRUE)

#Load Libraries
Libraries <- c("knitr", "readr", "tidyverse", "aod", "ggplot2")
for (p in Libraries) { 
    library(p, character.only = TRUE)
}
opts_chunk$set(cache=TRUE, warning=FALSE, message=FALSE)

#Load Data
df <- read_csv("CHD_preprocessed.csv", 
     col_types = cols(male = col_factor(levels = c("0", "1")), 
                      education = col_factor(levels = c("0", "1")),
                      currentSmoker = col_factor(levels = c("0", "1")), 
                      BPMeds = col_skip(), 
                      prevalentStroke = col_factor(levels = c("0", "1")), 
                      prevalentHyp = col_factor(levels = c("0", "1")), 
                      diabetes = col_factor(levels = c("0", "1")), 
                      TenYearCHD = col_factor(levels = c("0", "1"))))
#view(df)
```

### Logistic Regression Model Summary


```{r cache=TRUE}
mylogit <- glm(TenYearCHD ~ male + age + education + 
                 cigsPerDay + prevalentStroke + prevalentHyp + 
                 diabetes + totChol + sysBP + diaBP + BMI +
                 heartRate + glucose,
               data = df, family = "binomial")

summary(mylogit)
```


```{r}
wald.test(b = coef(mylogit), Sigma = vcov(mylogit), Terms = 4:6)
```

```{r}
## odds ratios only
table = exp(coef(mylogit))
table
```


```{r}
## odds ratios and 95% CI
df_odds <- exp(cbind(OR = coef(mylogit), confint(mylogit)))
#df_odds$OR

#colnames(df_odds)
#row.names(df_odds)
df_odds
```



You can also use predicted probabilities to help you understand the model. Predicted probabilities can be computed for both categorical and continuous predictor variables. In order to create predicted probabilities we first need to create a new data frame with the values we want the independent variables to take on to create our predictions.

We will start by calculating the predicted probability of admission at each value of rank, holding gre and gpa at their means. First we create and view the data frame.

newdata1 <- with(mydata, data.frame(gre = mean(gre), gpa = mean(gpa), rank = factor(1:4)))

Determine the prevalentStroke odds
```{r eval=FALSE, include=FALSE}
#    male1              age       education1   currentSmoker1 cigsPerDay 
# prevalentStroke1    prevalentHyp1        diabetes1          totChol            sysBP
#  BMI        heartRate          glucose

probability <- with(df, data.frame(male = mean(male), 
                                   age = mean(age), 
                                   prevalentHyp = mean(prevalentHyp),
                                   prevalentStroke = factor(0:1)))

## view probability
probability
```














